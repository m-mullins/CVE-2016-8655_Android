#include <linux/module.h>
#include <linux/kernel.h>
#include <linux/proc_fs.h>
#include <linux/string.h>
#include <linux/vmalloc.h>
#include <linux/uaccess.h>
#include <linux/sched.h>
#include <linux/pagemap.h>
#include <linux/highmem.h>
#include <linux/memcontrol.h>
#include <asm/pgtable.h>
#include <linux/kallsyms.h>
#include <linux/elf.h>
#include <linux/gfp.h>
#include <linux/kernel_stat.h>
#include <linux/mm.h>
#include <linux/hugetlb.h>
#include <linux/mman.h>
#include <linux/swap.h>
#include <linux/highmem.h>
#include <linux/pagemap.h>
#include <linux/ksm.h>
#include <linux/rmap.h>
#include <linux/export.h>
#include <linux/delayacct.h>
#include <linux/init.h>
#include <linux/writeback.h>
#include <linux/memcontrol.h>
#include <linux/mmu_notifier.h>
#include <linux/kallsyms.h>
#include <linux/swapops.h>
#include <linux/elf.h>
#include <linux/gfp.h>

#include <asm/io.h>
#include <asm/pgalloc.h>
#include <asm/uaccess.h>
#include <asm/tlb.h>
#include <asm/tlbflush.h>
#include <asm/pgtable.h>
#include "deviceconfig.h"


void lolrofl(unsigned long arg) {
    register struct list_head* listhead asm("r7");
    char* tempstr = (char*)arg;
    struct list_head* lh = (struct list_head*)(arg+2048);
    typedef int (*__trace_printk_ptr)(unsigned long ip, const char *fmt, ...);
    __trace_printk_ptr t = (__trace_printk_ptr)0xc007a4ec;

    listhead->next = lh;
    listhead->prev = lh;
    lh->next = listhead;
    lh->prev = listhead;

    //c007a4cc;
    //c007a4cc
    //typedef int (*printf_ptr)( const char* format, ... );
    //printf_ptr p = (printf_ptr)0xc03608e0;
    tempstr += 1024;
    t(0,tempstr,(void*)listhead);
    return;
}



#define MAX_LEN       4096
int init_module( void )
{
    lolrofl(0L);
    return 0;
}

void cleanup_module( void )
{
}

MODULE_LICENSE("GPL");
