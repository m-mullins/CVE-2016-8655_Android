struct packet_sock {
    /* struct sock has to be the first member of packet_sock */
    struct sock		sk;
    struct packet_fanout	*fanout;
    union  tpacket_stats_u	stats;
    struct packet_ring_buffer	rx_ring;
    struct packet_ring_buffer	tx_ring;
    int			copy_thresh;
    spinlock_t		bind_lock;
    struct mutex		pg_vec_lock;
    unsigned int		running:1,	/* prot_hook is attached*/
                                auxdata:1,
                                origdev:1,
                                has_vnet_hdr:1;
    int			ifindex;	/* bound device		*/
    __be16			num;
    struct packet_mclist	*mclist;
    atomic_t		mapped;
    enum tpacket_versions	tp_version;
    unsigned int		tp_hdrlen;
    unsigned int		tp_reserve;
    unsigned int		tp_loss:1;
    unsigned int		tp_tx_has_off:1;
    unsigned int		tp_tstamp;
    struct net_device __rcu	*cached_dev;
    struct packet_type	prot_hook ____cacheline_aligned_in_smp;
};


